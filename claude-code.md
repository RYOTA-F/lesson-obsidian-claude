# Claude Code

## 概要

Claude Code は、Anthropic が提供する AI コーディングアシスタントです。コマンドラインから直接使用でき、コードベースの理解、実装、リファクタリング、デバッグなど、開発ワークフロー全体をサポートします。

### 主な機能

- **コードベース理解**: プロジェクト全体の構造とパターンを分析
- **実装支援**: 機能追加、バグ修正、リファクタリング
- **[コマンド実行](command.md)**: git、npm、Docker など開発ツールとの統合
- **[サブエージェント](sub-agent.md)**: 複雑なタスクを独立したコンテキストで処理
- **[Claude Skills](claude-skills.md)**: 自動起動する機能拡張システム
- **コンテキスト管理**: [200K トークン](../context-engineering/context-window.md)のコンテキストウィンドウ

---

## 基本的な使い方

### セッションの開始

Claude Code を起動すると、現在のディレクトリをプロジェクトルートとして認識します。

```bash
claude
```

### 初回利用時の推奨ステップ

1. **プロジェクト構造の理解**

```
プロジェクトの構造を教えて
```

2. **CLAUDE.md の作成**

```
このプロジェクトのための CLAUDE.md を作成して
```

3. **タスクの実行**

```
ユーザー認証機能を実装して
```

---

## 効果的な使い方

### 明確な指示を与える

**❌ 悪い例:**

```
コードを良くして
```

**✅ 良い例:**

```
src/auth/login.ts の認証ロジックをリファクタリングして：
- エラーハンドリングを追加
- TypeScript の型安全性を向上
- テストカバレッジを 80% 以上に
```

### コンテキストを活用する

Claude Code は会話履歴とツール実行結果をコンテキストに保持します。

**段階的なアプローチ:**

```
1. "auth モジュールのコードを読んで"
2. "セキュリティ上の問題点を指摘して"
3. "指摘した問題を修正して"
```

### ファイル参照の明示

```
src/components/Button.tsx の Props 型を拡張して、
variant プロパティ（primary | secondary | danger）を追加
```

---

## ベストプラクティス

### 1. コンテキストウィンドウの管理

**監視コマンド:**

```
/context
```

**使用率の目安:**

| 使用率 | 状態    | 推奨アクション         |
| ------ | ------- | ---------------------- |
| 0-50%  | 🟢 正常 | 通常通り作業可能       |
| 50-75% | 🟡 注意 | 不要な操作を避ける     |
| 75-85% | 🟠 警告 | 効率的な操作を心がける |
| 85%+   | 🔴 危険 | 圧縮または新セッション |

**コンテキスト圧縮:**

```
/compact
```

### 2. [サブエージェント](sub-agent.md)の活用

大規模な分析や複雑なタスクは、サブエージェントに委譲します。

**自動起動されるケース:**

- プロジェクト全体のコード検索
- 大量ファイルの分析
- セキュリティ監査
- パフォーマンス分析

**手動起動:**

```
Explore エージェントを使って、
認証関連のコードを全て見つけて分析して
```

### 3. 段階的な実装

一度に全てを実装せず、段階的に進めます。

**段階的なワークフロー:**

```
1. 要件の確認と設計
2. 小さな単位で実装
3. テストの追加
4. リファクタリング
5. ドキュメント更新
```

### 4. Git ワークフロー

**セッション開始時:**

```bash
git status
git branch
```

**作業前にブランチ作成:**

```
feature/user-authentication ブランチを作成して切り替えて
```

**コミット:**

```
変更をコミットして（適切なコミットメッセージで）
```

---

## 一般的なパターン

### 新機能の実装

```
1. "ユーザープロファイル編集機能の要件を確認させて"
2. 要件の明確化（対話）
3. "設計を提案して"
4. 設計のレビュー（対話）
5. "実装して"
6. "テストを追加して"
7. "動作確認のための手順を教えて"
```

### バグ修正

```
1. "src/api/users.ts:45 でエラーが発生している。調査して"
2. "原因を特定できた？"
3. "修正して"
4. "このバグを防ぐためのテストを追加して"
```

### リファクタリング

```
1. "src/utils/ 配下のコードを分析して、改善点を挙げて"
2. 改善提案のレビュー
3. "提案された改善を実装して"
4. "既存のテストが全て通ることを確認して"
```

### コードレビュー

```
1. "最新の変更を git diff で確認して"
2. "コードレビューして：
   - セキュリティ
   - パフォーマンス
   - 可読性
   - テストカバレッジ"
3. レビュー結果に基づいて改善
```

---

## トラブルシューティング

### コンテキストが一杯になった

**症状:**

- 過去の指示を忘れる
- 同じ間違いを繰り返す
- 応答が遅くなる

**解決策:**

```
/compact         # コンテキストを圧縮
/clear           # 新しいセッションを開始
```

重要な情報は CLAUDE.md やドキュメントに記録します。

### 意図しない変更が行われた

**ロールバック:**

```bash
git diff          # 変更内容を確認
git checkout .    # 全ての変更を破棄
git checkout -- <file>  # 特定ファイルのみ破棄
```

### ファイルが見つからない

**原因:**

- 相対パスの誤り
- ファイル名の typo
- ディレクトリ構造の誤解

**確認方法:**

```
カレントディレクトリを確認して
プロジェクトルートからのファイル一覧を表示して
```

### エラーメッセージが理解できない

```
以下のエラーを分析して、原因と解決方法を教えて：

[エラーメッセージをペースト]
```

---

## パフォーマンス最適化

### 1. 選択的なファイル読み込み

**❌ 非効率:**

```
src/ 配下の全ファイルを読んで
```

**✅ 効率的:**

```
src/auth/ 配下の認証関連ファイルのみを読んで
```

### 2. 検索の活用

```
"getUserData" 関数を検索して、使用箇所を教えて
```

### 3. サブエージェントの活用

大規模な分析は自動的にサブエージェントに委譲されますが、手動でも指定できます。

```
Explore エージェントを使って、
プロジェクト全体のセキュリティ脆弱性を検査して
```

---

## 高度なテクニック

### プロジェクト固有のルール

CLAUDE.md にプロジェクト固有のルールを記載します。

**例:**

```markdown
## コーディング規約

- TypeScript strict モード必須
- テストカバレッジ 80% 以上
- ESLint エラーゼロ
- すべての API は OpenAPI 仕様に準拠
```

### テンプレートの活用

よく使うパターンをテンプレート化します。

```
docs/templates/feature.md のテンプレートに従って、
新機能「通知システム」のドキュメントを作成して
```

### ワークフローの自動化

```
以下のワークフローを実行して：
1. テストを実行
2. 全て通れば、ビルド
3. ビルドが成功したら、コミット
```

---

## セキュリティとプライバシー

### 機密情報の取り扱い

**絶対に送信しないもの:**

- API キー、パスワード
- 個人情報（メールアドレス、電話番号など）
- 機密のビジネスロジック

**.gitignore の活用:**

```gitignore
.env
.env.local
credentials.json
secrets/
```

### コード所有権

- Claude Code が生成したコードの著作権はユーザーに帰属
- 生成されたコードのレビューと検証は必須
- プロダクション環境へのデプロイ前に十分なテストを実施

---

## [コマンドリファレンス](command.md)

詳細は [コマンド一覧](command.md) を参照してください。

### よく使うコマンド

| コマンド   | 説明                       |
| ---------- | -------------------------- |
| `/help`    | ヘルプを表示               |
| `/context` | コンテキスト使用状況を表示 |
| `/compact` | コンテキストを圧縮         |
| `/clear`   | 会話履歴をクリア           |

---

## 関連ドキュメント

- [コマンド一覧](command.md): 全ての利用可能なコマンド
- [サブエージェント](sub-agent.md): Task ツールとエージェント活用
- [コンテキストエンジニアリング](../context-engineering/context-engineering.md): 効率的なコンテキスト管理
- [コンテキストウィンドウ](../context-engineering/context-window.md): コンテキストの仕組み

---

## 参考リンク

- [Claude Code 公式ドキュメント](https://docs.claude.com/claude-code)
- [Anthropic Developer Documentation](https://docs.anthropic.com/)
- [Claude Code GitHub](https://github.com/anthropics/claude-code)

---

## まとめ

Claude Code は強力な AI コーディングアシスタントですが、効果的に使うには：

1. **明確な指示**: 具体的で段階的な指示を与える
2. **コンテキスト管理**: [コンテキストウィンドウ](../context-engineering/context-window.md)を意識した効率的な使い方
3. **サブエージェント活用**: 複雑なタスクは[サブエージェント](sub-agent.md)に委譲
4. **段階的実装**: 小さな単位で実装 → テスト → リファクタリング
5. **Git ワークフロー**: ブランチ作成、頻繁なコミット、レビュー

適切に活用することで、開発生産性を 10 倍、20 倍に引き上げることができます。
